<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>검색 결과</title>
</head>
<body>
<div th:replace="~{layout.html :: content}">
<h1>상품 검색 결과</h1>

<!-- 검색 필터 폼 -->
<form action="/main/search" method="get">
    <label for="name">상품명:</label>
    <input type="text" id="name" name="name" placeholder="상품명을 입력하세요"
           th:value="${param.name}" />
    <br>

    <label for="category1">대분류:</label>
    <select id="category1" name="category1" onchange="this.form.submit()">
        <option value="">-- 선택하세요 --</option>
        <option value="디지털/가전" th:selected="${param.category1 == '디지털/가전'}">디지털/가전</option>
        <option value="가구" th:selected="${param.category1 == '가구'}">가구</option>
        <!-- 다른 대분류 추가 -->
    </select>

    <label for="category2">중분류:</label>
    <select id="category2" name="category2" onchange="this.form.submit()">
        <option value="">-- 선택하세요 --</option>
        <option value="영상가전" th:selected="${param.category2 == '영상가전'}">영상가전</option>
        <option value="생활가전" th:selected="${param.category2 == '생활가전'}">생활가전</option>
        <!-- 다른 중분류 추가 -->
    </select>

    <label for="category3">소분류:</label>
    <select id="category3" name="category3" onchange="this.form.submit()">
        <option value="">-- 선택하세요 --</option>
        <option value="TV" th:selected="${param.category3 == 'TV'}">TV</option>
        <option value="세탁기" th:selected="${param.category3 == '세탁기'}">세탁기</option>
        <!-- 다른 소분류 추가 -->
    </select>

    <label for="category4">세부분류:</label>
    <select id="category4" name="category4" onchange="this.form.submit()">
        <option value="">-- 선택하세요 --</option>
        <option value="LEDTV" th:selected="${param.category4 == 'LEDTV'}">LEDTV</option>
        <option value="OLEDTV" th:selected="${param.category4 == 'OLEDTV'}">OLEDTV</option>
        <!-- 다른 세부분류 추가 -->
    </select>
</form>

<!-- 검색 결과가 없을 때 메시지 표시 -->
<div th:if="${message != null}">
    <p th:text="${message}"></p>
</div>

<!-- 검색된 상품 목록 표시 -->
<table>
    <thead>
    <tr>
        <th>이미지</th>
        <th>상품명</th>
        <th>가격</th>
        <th>카테고리</th>
        <th>상세 링크</th>
        <th>위시리스트 추가</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="product : ${products}">
        <!-- 상품 이미지 -->
        <td>
            <img th:src="${product.image}" alt="상품 이미지" style="width:100px;height:auto;">
        </td>
        <!-- 상품명 -->
        <td th:text="${product.title}"></td>
        <!-- 가격 -->
        <td th:text="${product.lprice}"></td>
        <!-- 카테고리 -->
        <td th:text="${product.category1} + ' > ' + ${product.category2} + ' > ' + ${product.category3} + ' > ' + ${product.category4}"></td>
        <!-- 상세 링크 -->
        <td>
            <a th:href="${product.link}" target="_blank">상세 보기</a>
        </td>
        <td>
            <form th:action="@{/users/wishlist/add}" method="post">
                <input type="hidden" name="productId" th:value="${product.id}">
                <button type="submit">위시리스트에 추가</button>
            </form>
        </td>
    </tr>
    </tbody>
</table>
</div>
</body>
</html>
